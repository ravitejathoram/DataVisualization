{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 185,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "def load_data(path):\n",
    "    return pd.read_csv(path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>country</th>\n",
       "      <th>Region</th>\n",
       "      <th>Population in thousands (2017)</th>\n",
       "      <th>Population density (per km2, 2017)</th>\n",
       "      <th>Sex ratio (m per 100 f, 2017)</th>\n",
       "      <th>GDP: Gross domestic product (million current US$)</th>\n",
       "      <th>GDP growth rate (annual %, const. 2005 prices)</th>\n",
       "      <th>GDP per capita (current US$)</th>\n",
       "      <th>Economy: Agriculture (% of GVA)</th>\n",
       "      <th>Economy: Industry (% of GVA)</th>\n",
       "      <th>...</th>\n",
       "      <th>Unemployment (% of labour force)</th>\n",
       "      <th>International trade: Balance (million US$)</th>\n",
       "      <th>Population growth rate (average annual %)</th>\n",
       "      <th>Urban population (% of total population)</th>\n",
       "      <th>Fertility rate, total (live births per woman)</th>\n",
       "      <th>Population age distribution (0-14 / 60+ years, %)</th>\n",
       "      <th>Individuals using the Internet (per 100 inhabitants)</th>\n",
       "      <th>Threatened species (number)</th>\n",
       "      <th>Forested area (% of land area)</th>\n",
       "      <th>CO2 emission estimates (million tons/tons per capita)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>SouthernAsia</td>\n",
       "      <td>35530</td>\n",
       "      <td>54.4</td>\n",
       "      <td>106.3</td>\n",
       "      <td>20270</td>\n",
       "      <td>-2.4</td>\n",
       "      <td>623.2</td>\n",
       "      <td>23.3</td>\n",
       "      <td>23.3</td>\n",
       "      <td>...</td>\n",
       "      <td>8.6</td>\n",
       "      <td>-2110</td>\n",
       "      <td>3.2</td>\n",
       "      <td>26.7</td>\n",
       "      <td>5.3</td>\n",
       "      <td>43.2/4.1</td>\n",
       "      <td>42</td>\n",
       "      <td>2.1</td>\n",
       "      <td>9.8/0.3</td>\n",
       "      <td>63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Albania</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>2930</td>\n",
       "      <td>106.9</td>\n",
       "      <td>101.9</td>\n",
       "      <td>11541</td>\n",
       "      <td>2.6</td>\n",
       "      <td>3984.2</td>\n",
       "      <td>22.4</td>\n",
       "      <td>26.0</td>\n",
       "      <td>...</td>\n",
       "      <td>15.8</td>\n",
       "      <td>-2707</td>\n",
       "      <td>-0.1</td>\n",
       "      <td>57.4</td>\n",
       "      <td>1.7</td>\n",
       "      <td>17.4/19.0</td>\n",
       "      <td>130</td>\n",
       "      <td>28.2</td>\n",
       "      <td>5.7/2.0</td>\n",
       "      <td>84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Algeria</td>\n",
       "      <td>NorthernAfrica</td>\n",
       "      <td>41318</td>\n",
       "      <td>17.3</td>\n",
       "      <td>102.0</td>\n",
       "      <td>164779</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4154.1</td>\n",
       "      <td>12.2</td>\n",
       "      <td>37.3</td>\n",
       "      <td>...</td>\n",
       "      <td>11.4</td>\n",
       "      <td>-17099</td>\n",
       "      <td>2</td>\n",
       "      <td>70.7</td>\n",
       "      <td>3</td>\n",
       "      <td>29.3/9.4</td>\n",
       "      <td>135</td>\n",
       "      <td>0.8</td>\n",
       "      <td>145.4/3.7</td>\n",
       "      <td>5900</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>American Samoa</td>\n",
       "      <td>Polynesia</td>\n",
       "      <td>56</td>\n",
       "      <td>278.2</td>\n",
       "      <td>103.6</td>\n",
       "      <td>-99</td>\n",
       "      <td>-99</td>\n",
       "      <td>-99.0</td>\n",
       "      <td>-99</td>\n",
       "      <td>-99.0</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>-99</td>\n",
       "      <td>-~0.0</td>\n",
       "      <td>87.2</td>\n",
       "      <td>2.6</td>\n",
       "      <td>33.3/9.0</td>\n",
       "      <td>92</td>\n",
       "      <td>87.9</td>\n",
       "      <td>-99</td>\n",
       "      <td>-99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Andorra</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>77</td>\n",
       "      <td>163.8</td>\n",
       "      <td>102.3</td>\n",
       "      <td>2812</td>\n",
       "      <td>0.8</td>\n",
       "      <td>39896.4</td>\n",
       "      <td>0.5</td>\n",
       "      <td>10.8</td>\n",
       "      <td>...</td>\n",
       "      <td>-99</td>\n",
       "      <td>-1255</td>\n",
       "      <td>-1.6</td>\n",
       "      <td>85.1</td>\n",
       "      <td>1.2</td>\n",
       "      <td>14.4/19.0</td>\n",
       "      <td>13</td>\n",
       "      <td>34</td>\n",
       "      <td>0.5/6.4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          country          Region  Population in thousands (2017)  \\\n",
       "0     Afghanistan    SouthernAsia                           35530   \n",
       "1         Albania  SouthernEurope                            2930   \n",
       "2         Algeria  NorthernAfrica                           41318   \n",
       "3  American Samoa       Polynesia                              56   \n",
       "4         Andorra  SouthernEurope                              77   \n",
       "\n",
       "   Population density (per km2, 2017)  Sex ratio (m per 100 f, 2017)  \\\n",
       "0                                54.4                          106.3   \n",
       "1                               106.9                          101.9   \n",
       "2                                17.3                          102.0   \n",
       "3                               278.2                          103.6   \n",
       "4                               163.8                          102.3   \n",
       "\n",
       "   GDP: Gross domestic product (million current US$)  \\\n",
       "0                                              20270   \n",
       "1                                              11541   \n",
       "2                                             164779   \n",
       "3                                                -99   \n",
       "4                                               2812   \n",
       "\n",
       "  GDP growth rate (annual %, const. 2005 prices)  \\\n",
       "0                                           -2.4   \n",
       "1                                            2.6   \n",
       "2                                            3.8   \n",
       "3                                            -99   \n",
       "4                                            0.8   \n",
       "\n",
       "   GDP per capita (current US$) Economy: Agriculture (% of GVA)  \\\n",
       "0                         623.2                            23.3   \n",
       "1                        3984.2                            22.4   \n",
       "2                        4154.1                            12.2   \n",
       "3                         -99.0                             -99   \n",
       "4                       39896.4                             0.5   \n",
       "\n",
       "   Economy: Industry (% of GVA)  \\\n",
       "0                          23.3   \n",
       "1                          26.0   \n",
       "2                          37.3   \n",
       "3                         -99.0   \n",
       "4                          10.8   \n",
       "\n",
       "                           ...                           \\\n",
       "0                          ...                            \n",
       "1                          ...                            \n",
       "2                          ...                            \n",
       "3                          ...                            \n",
       "4                          ...                            \n",
       "\n",
       "   Unemployment (% of labour force)  \\\n",
       "0                               8.6   \n",
       "1                              15.8   \n",
       "2                              11.4   \n",
       "3                               ...   \n",
       "4                               -99   \n",
       "\n",
       "  International trade: Balance (million US$)  \\\n",
       "0                                      -2110   \n",
       "1                                      -2707   \n",
       "2                                     -17099   \n",
       "3                                        -99   \n",
       "4                                      -1255   \n",
       "\n",
       "  Population growth rate (average annual %)  \\\n",
       "0                                       3.2   \n",
       "1                                      -0.1   \n",
       "2                                         2   \n",
       "3                                     -~0.0   \n",
       "4                                      -1.6   \n",
       "\n",
       "  Urban population (% of total population)  \\\n",
       "0                                     26.7   \n",
       "1                                     57.4   \n",
       "2                                     70.7   \n",
       "3                                     87.2   \n",
       "4                                     85.1   \n",
       "\n",
       "  Fertility rate, total (live births per woman)  \\\n",
       "0                                           5.3   \n",
       "1                                           1.7   \n",
       "2                                             3   \n",
       "3                                           2.6   \n",
       "4                                           1.2   \n",
       "\n",
       "  Population age distribution (0-14 / 60+ years, %)  \\\n",
       "0                                          43.2/4.1   \n",
       "1                                         17.4/19.0   \n",
       "2                                          29.3/9.4   \n",
       "3                                          33.3/9.0   \n",
       "4                                         14.4/19.0   \n",
       "\n",
       "  Individuals using the Internet (per 100 inhabitants)  \\\n",
       "0                                                 42     \n",
       "1                                                130     \n",
       "2                                                135     \n",
       "3                                                 92     \n",
       "4                                                 13     \n",
       "\n",
       "   Threatened species (number) Forested area (% of land area)  \\\n",
       "0                          2.1                        9.8/0.3   \n",
       "1                         28.2                        5.7/2.0   \n",
       "2                          0.8                      145.4/3.7   \n",
       "3                         87.9                            -99   \n",
       "4                           34                        0.5/6.4   \n",
       "\n",
       "  CO2 emission estimates (million tons/tons per capita)  \n",
       "0                                                 63     \n",
       "1                                                 84     \n",
       "2                                               5900     \n",
       "3                                                -99     \n",
       "4                                                  1     \n",
       "\n",
       "[5 rows x 24 columns]"
      ]
     },
     "execution_count": 186,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = load_data(\"country_profile_variables.csv\")\n",
    "columns = data.columns\n",
    "data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 229 entries, 0 to 228\n",
      "Data columns (total 24 columns):\n",
      "country                                                  229 non-null object\n",
      "Region                                                   229 non-null object\n",
      "Population in thousands (2017)                           229 non-null int64\n",
      "Population density (per km2, 2017)                       229 non-null float64\n",
      "Sex ratio (m per 100 f, 2017)                            229 non-null float64\n",
      "GDP: Gross domestic product (million current US$)        229 non-null int64\n",
      "GDP growth rate (annual %, const. 2005 prices)           229 non-null object\n",
      "GDP per capita (current US$)                             229 non-null float64\n",
      "Economy: Agriculture (% of GVA)                          229 non-null object\n",
      "Economy: Industry (% of GVA)                             229 non-null float64\n",
      "Economy: Services and other activity (% of GVA)          229 non-null float64\n",
      "Employment: Agriculture (% of employed)                  229 non-null object\n",
      "Employment: Industry (% of employed)                     229 non-null object\n",
      "Employment: Services (% of employed)                     229 non-null object\n",
      "Unemployment (% of labour force)                         229 non-null object\n",
      "International trade: Balance (million US$)               229 non-null object\n",
      "Population growth rate (average annual %)                229 non-null object\n",
      "Urban population (% of total population)                 229 non-null float64\n",
      "Fertility rate, total (live births per woman)            229 non-null object\n",
      "Population age distribution (0-14 / 60+ years, %)        229 non-null object\n",
      "Individuals using the Internet (per 100 inhabitants)     229 non-null int64\n",
      "Threatened species (number)                              229 non-null object\n",
      "Forested area (% of land area)                           229 non-null object\n",
      "CO2 emission estimates (million tons/tons per capita)    229 non-null int64\n",
      "dtypes: float64(6), int64(4), object(14)\n",
      "memory usage: 43.0+ KB\n"
     ]
    }
   ],
   "source": [
    "data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Population in thousands (2017)</th>\n",
       "      <th>Population density (per km2, 2017)</th>\n",
       "      <th>Sex ratio (m per 100 f, 2017)</th>\n",
       "      <th>GDP: Gross domestic product (million current US$)</th>\n",
       "      <th>GDP per capita (current US$)</th>\n",
       "      <th>Economy: Industry (% of GVA)</th>\n",
       "      <th>Economy: Services and other activity (% of GVA)</th>\n",
       "      <th>Urban population (% of total population)</th>\n",
       "      <th>Individuals using the Internet (per 100 inhabitants)</th>\n",
       "      <th>CO2 emission estimates (million tons/tons per capita)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>2.290000e+02</td>\n",
       "      <td>229.000000</td>\n",
       "      <td>229.000000</td>\n",
       "      <td>2.290000e+02</td>\n",
       "      <td>229.000000</td>\n",
       "      <td>229.000000</td>\n",
       "      <td>229.000000</td>\n",
       "      <td>229.000000</td>\n",
       "      <td>229.000000</td>\n",
       "      <td>229.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>3.275679e+04</td>\n",
       "      <td>462.824891</td>\n",
       "      <td>100.202183</td>\n",
       "      <td>3.214339e+05</td>\n",
       "      <td>14251.877729</td>\n",
       "      <td>15.958952</td>\n",
       "      <td>46.408734</td>\n",
       "      <td>59.508734</td>\n",
       "      <td>198.711790</td>\n",
       "      <td>2464.262009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>1.332751e+05</td>\n",
       "      <td>2305.384253</td>\n",
       "      <td>28.327837</td>\n",
       "      <td>1.478690e+06</td>\n",
       "      <td>23391.266933</td>\n",
       "      <td>38.684631</td>\n",
       "      <td>48.603730</td>\n",
       "      <td>25.206404</td>\n",
       "      <td>296.453089</td>\n",
       "      <td>9912.891745</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1.000000e+00</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>-99.000000</td>\n",
       "      <td>-9.900000e+01</td>\n",
       "      <td>-99.000000</td>\n",
       "      <td>-99.000000</td>\n",
       "      <td>-99.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>-99.000000</td>\n",
       "      <td>-99.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>4.310000e+02</td>\n",
       "      <td>35.900000</td>\n",
       "      <td>96.400000</td>\n",
       "      <td>2.078000e+03</td>\n",
       "      <td>1207.900000</td>\n",
       "      <td>15.400000</td>\n",
       "      <td>47.300000</td>\n",
       "      <td>39.800000</td>\n",
       "      <td>55.000000</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>5.448000e+03</td>\n",
       "      <td>88.100000</td>\n",
       "      <td>99.000000</td>\n",
       "      <td>1.625100e+04</td>\n",
       "      <td>4836.100000</td>\n",
       "      <td>25.500000</td>\n",
       "      <td>59.500000</td>\n",
       "      <td>59.900000</td>\n",
       "      <td>97.000000</td>\n",
       "      <td>108.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>1.919300e+04</td>\n",
       "      <td>222.800000</td>\n",
       "      <td>101.700000</td>\n",
       "      <td>1.179550e+05</td>\n",
       "      <td>16344.100000</td>\n",
       "      <td>32.800000</td>\n",
       "      <td>70.700000</td>\n",
       "      <td>79.600000</td>\n",
       "      <td>196.000000</td>\n",
       "      <td>961.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>1.409517e+06</td>\n",
       "      <td>25969.800000</td>\n",
       "      <td>301.200000</td>\n",
       "      <td>1.803665e+07</td>\n",
       "      <td>169491.800000</td>\n",
       "      <td>79.900000</td>\n",
       "      <td>94.000000</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>2358.000000</td>\n",
       "      <td>101394.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Population in thousands (2017)  Population density (per km2, 2017)  \\\n",
       "count                    2.290000e+02                          229.000000   \n",
       "mean                     3.275679e+04                          462.824891   \n",
       "std                      1.332751e+05                         2305.384253   \n",
       "min                      1.000000e+00                            0.100000   \n",
       "25%                      4.310000e+02                           35.900000   \n",
       "50%                      5.448000e+03                           88.100000   \n",
       "75%                      1.919300e+04                          222.800000   \n",
       "max                      1.409517e+06                        25969.800000   \n",
       "\n",
       "       Sex ratio (m per 100 f, 2017)  \\\n",
       "count                     229.000000   \n",
       "mean                      100.202183   \n",
       "std                        28.327837   \n",
       "min                       -99.000000   \n",
       "25%                        96.400000   \n",
       "50%                        99.000000   \n",
       "75%                       101.700000   \n",
       "max                       301.200000   \n",
       "\n",
       "       GDP: Gross domestic product (million current US$)  \\\n",
       "count                                       2.290000e+02   \n",
       "mean                                        3.214339e+05   \n",
       "std                                         1.478690e+06   \n",
       "min                                        -9.900000e+01   \n",
       "25%                                         2.078000e+03   \n",
       "50%                                         1.625100e+04   \n",
       "75%                                         1.179550e+05   \n",
       "max                                         1.803665e+07   \n",
       "\n",
       "       GDP per capita (current US$)  Economy: Industry (% of GVA)  \\\n",
       "count                    229.000000                    229.000000   \n",
       "mean                   14251.877729                     15.958952   \n",
       "std                    23391.266933                     38.684631   \n",
       "min                      -99.000000                    -99.000000   \n",
       "25%                     1207.900000                     15.400000   \n",
       "50%                     4836.100000                     25.500000   \n",
       "75%                    16344.100000                     32.800000   \n",
       "max                   169491.800000                     79.900000   \n",
       "\n",
       "       Economy: Services and other activity (% of GVA)  \\\n",
       "count                                       229.000000   \n",
       "mean                                         46.408734   \n",
       "std                                          48.603730   \n",
       "min                                         -99.000000   \n",
       "25%                                          47.300000   \n",
       "50%                                          59.500000   \n",
       "75%                                          70.700000   \n",
       "max                                          94.000000   \n",
       "\n",
       "       Urban population (% of total population)  \\\n",
       "count                                229.000000   \n",
       "mean                                  59.508734   \n",
       "std                                   25.206404   \n",
       "min                                    0.000000   \n",
       "25%                                   39.800000   \n",
       "50%                                   59.900000   \n",
       "75%                                   79.600000   \n",
       "max                                  100.000000   \n",
       "\n",
       "       Individuals using the Internet (per 100 inhabitants)  \\\n",
       "count                                         229.000000      \n",
       "mean                                          198.711790      \n",
       "std                                           296.453089      \n",
       "min                                           -99.000000      \n",
       "25%                                            55.000000      \n",
       "50%                                            97.000000      \n",
       "75%                                           196.000000      \n",
       "max                                          2358.000000      \n",
       "\n",
       "       CO2 emission estimates (million tons/tons per capita)  \n",
       "count                                         229.000000      \n",
       "mean                                         2464.262009      \n",
       "std                                          9912.891745      \n",
       "min                                           -99.000000      \n",
       "25%                                             2.000000      \n",
       "50%                                           108.000000      \n",
       "75%                                           961.000000      \n",
       "max                                        101394.000000      "
      ]
     },
     "execution_count": 188,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 189,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>country</th>\n",
       "      <th>Region</th>\n",
       "      <th>Population in thousands (2017)</th>\n",
       "      <th>Population density (per km2, 2017)</th>\n",
       "      <th>Sex ratio (m per 100 f, 2017)</th>\n",
       "      <th>GDP: Gross domestic product (million current US$)</th>\n",
       "      <th>GDP growth rate (annual %, const. 2005 prices)</th>\n",
       "      <th>GDP per capita (current US$)</th>\n",
       "      <th>Economy: Agriculture (% of GVA)</th>\n",
       "      <th>Economy: Industry (% of GVA)</th>\n",
       "      <th>...</th>\n",
       "      <th>Unemployment (% of labour force)</th>\n",
       "      <th>International trade: Balance (million US$)</th>\n",
       "      <th>Population growth rate (average annual %)</th>\n",
       "      <th>Urban population (% of total population)</th>\n",
       "      <th>Fertility rate, total (live births per woman)</th>\n",
       "      <th>Population age distribution (0-14 / 60+ years, %)</th>\n",
       "      <th>Individuals using the Internet (per 100 inhabitants)</th>\n",
       "      <th>Threatened species (number)</th>\n",
       "      <th>Forested area (% of land area)</th>\n",
       "      <th>CO2 emission estimates (million tons/tons per capita)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>SouthernAsia</td>\n",
       "      <td>35530</td>\n",
       "      <td>54.4</td>\n",
       "      <td>106.3</td>\n",
       "      <td>20270</td>\n",
       "      <td>-2.4</td>\n",
       "      <td>623.2</td>\n",
       "      <td>23.3</td>\n",
       "      <td>23.3</td>\n",
       "      <td>...</td>\n",
       "      <td>8.6</td>\n",
       "      <td>-2110</td>\n",
       "      <td>3.2</td>\n",
       "      <td>26.7</td>\n",
       "      <td>5.3</td>\n",
       "      <td>43.2/4.1</td>\n",
       "      <td>42</td>\n",
       "      <td>2.1</td>\n",
       "      <td>9.8/0.3</td>\n",
       "      <td>63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Albania</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>2930</td>\n",
       "      <td>106.9</td>\n",
       "      <td>101.9</td>\n",
       "      <td>11541</td>\n",
       "      <td>2.6</td>\n",
       "      <td>3984.2</td>\n",
       "      <td>22.4</td>\n",
       "      <td>26.0</td>\n",
       "      <td>...</td>\n",
       "      <td>15.8</td>\n",
       "      <td>-2707</td>\n",
       "      <td>-0.1</td>\n",
       "      <td>57.4</td>\n",
       "      <td>1.7</td>\n",
       "      <td>17.4/19.0</td>\n",
       "      <td>130</td>\n",
       "      <td>28.2</td>\n",
       "      <td>5.7/2.0</td>\n",
       "      <td>84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Algeria</td>\n",
       "      <td>NorthernAfrica</td>\n",
       "      <td>41318</td>\n",
       "      <td>17.3</td>\n",
       "      <td>102.0</td>\n",
       "      <td>164779</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4154.1</td>\n",
       "      <td>12.2</td>\n",
       "      <td>37.3</td>\n",
       "      <td>...</td>\n",
       "      <td>11.4</td>\n",
       "      <td>-17099</td>\n",
       "      <td>2.0</td>\n",
       "      <td>70.7</td>\n",
       "      <td>3</td>\n",
       "      <td>29.3/9.4</td>\n",
       "      <td>135</td>\n",
       "      <td>0.8</td>\n",
       "      <td>145.4/3.7</td>\n",
       "      <td>5900</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Andorra</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>77</td>\n",
       "      <td>163.8</td>\n",
       "      <td>102.3</td>\n",
       "      <td>2812</td>\n",
       "      <td>0.8</td>\n",
       "      <td>39896.4</td>\n",
       "      <td>0.5</td>\n",
       "      <td>10.8</td>\n",
       "      <td>...</td>\n",
       "      <td>-99</td>\n",
       "      <td>-1255</td>\n",
       "      <td>-1.6</td>\n",
       "      <td>85.1</td>\n",
       "      <td>1.2</td>\n",
       "      <td>14.4/19.0</td>\n",
       "      <td>13</td>\n",
       "      <td>34</td>\n",
       "      <td>0.5/6.4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Angola</td>\n",
       "      <td>MiddleAfrica</td>\n",
       "      <td>29784</td>\n",
       "      <td>23.9</td>\n",
       "      <td>96.2</td>\n",
       "      <td>117955</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4714.1</td>\n",
       "      <td>6.8</td>\n",
       "      <td>51.2</td>\n",
       "      <td>...</td>\n",
       "      <td>6.6</td>\n",
       "      <td>12221</td>\n",
       "      <td>3.5</td>\n",
       "      <td>44.1</td>\n",
       "      <td>6</td>\n",
       "      <td>46.8/4.0</td>\n",
       "      <td>146</td>\n",
       "      <td>46.5</td>\n",
       "      <td>34.8/1.4</td>\n",
       "      <td>3902</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       country          Region  Population in thousands (2017)  \\\n",
       "0  Afghanistan    SouthernAsia                           35530   \n",
       "1      Albania  SouthernEurope                            2930   \n",
       "2      Algeria  NorthernAfrica                           41318   \n",
       "4      Andorra  SouthernEurope                              77   \n",
       "5       Angola    MiddleAfrica                           29784   \n",
       "\n",
       "   Population density (per km2, 2017)  Sex ratio (m per 100 f, 2017)  \\\n",
       "0                                54.4                          106.3   \n",
       "1                               106.9                          101.9   \n",
       "2                                17.3                          102.0   \n",
       "4                               163.8                          102.3   \n",
       "5                                23.9                           96.2   \n",
       "\n",
       "   GDP: Gross domestic product (million current US$)  \\\n",
       "0                                              20270   \n",
       "1                                              11541   \n",
       "2                                             164779   \n",
       "4                                               2812   \n",
       "5                                             117955   \n",
       "\n",
       "   GDP growth rate (annual %, const. 2005 prices)  \\\n",
       "0                                            -2.4   \n",
       "1                                             2.6   \n",
       "2                                             3.8   \n",
       "4                                             0.8   \n",
       "5                                             3.0   \n",
       "\n",
       "   GDP per capita (current US$) Economy: Agriculture (% of GVA)  \\\n",
       "0                         623.2                            23.3   \n",
       "1                        3984.2                            22.4   \n",
       "2                        4154.1                            12.2   \n",
       "4                       39896.4                             0.5   \n",
       "5                        4714.1                             6.8   \n",
       "\n",
       "   Economy: Industry (% of GVA)  \\\n",
       "0                          23.3   \n",
       "1                          26.0   \n",
       "2                          37.3   \n",
       "4                          10.8   \n",
       "5                          51.2   \n",
       "\n",
       "                           ...                           \\\n",
       "0                          ...                            \n",
       "1                          ...                            \n",
       "2                          ...                            \n",
       "4                          ...                            \n",
       "5                          ...                            \n",
       "\n",
       "   Unemployment (% of labour force)  \\\n",
       "0                               8.6   \n",
       "1                              15.8   \n",
       "2                              11.4   \n",
       "4                               -99   \n",
       "5                               6.6   \n",
       "\n",
       "  International trade: Balance (million US$)  \\\n",
       "0                                      -2110   \n",
       "1                                      -2707   \n",
       "2                                     -17099   \n",
       "4                                      -1255   \n",
       "5                                      12221   \n",
       "\n",
       "  Population growth rate (average annual %)  \\\n",
       "0                                       3.2   \n",
       "1                                      -0.1   \n",
       "2                                       2.0   \n",
       "4                                      -1.6   \n",
       "5                                       3.5   \n",
       "\n",
       "  Urban population (% of total population)  \\\n",
       "0                                     26.7   \n",
       "1                                     57.4   \n",
       "2                                     70.7   \n",
       "4                                     85.1   \n",
       "5                                     44.1   \n",
       "\n",
       "  Fertility rate, total (live births per woman)  \\\n",
       "0                                           5.3   \n",
       "1                                           1.7   \n",
       "2                                             3   \n",
       "4                                           1.2   \n",
       "5                                             6   \n",
       "\n",
       "  Population age distribution (0-14 / 60+ years, %)  \\\n",
       "0                                          43.2/4.1   \n",
       "1                                         17.4/19.0   \n",
       "2                                          29.3/9.4   \n",
       "4                                         14.4/19.0   \n",
       "5                                          46.8/4.0   \n",
       "\n",
       "   Individuals using the Internet (per 100 inhabitants)  \\\n",
       "0                                                 42      \n",
       "1                                                130      \n",
       "2                                                135      \n",
       "4                                                 13      \n",
       "5                                                146      \n",
       "\n",
       "   Threatened species (number) Forested area (% of land area)  \\\n",
       "0                          2.1                        9.8/0.3   \n",
       "1                         28.2                        5.7/2.0   \n",
       "2                          0.8                      145.4/3.7   \n",
       "4                           34                        0.5/6.4   \n",
       "5                         46.5                       34.8/1.4   \n",
       "\n",
       "  CO2 emission estimates (million tons/tons per capita)  \n",
       "0                                                 63     \n",
       "1                                                 84     \n",
       "2                                               5900     \n",
       "4                                                  1     \n",
       "5                                               3902     \n",
       "\n",
       "[5 rows x 24 columns]"
      ]
     },
     "execution_count": 189,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = data[data[\"GDP per capita (current US$)\"] != -99]\n",
    "data = data[data[\"GDP growth rate (annual %, const. 2005 prices)\"] != -99]\n",
    "data = data[data[\"GDP growth rate (annual %, const. 2005 prices)\"] != \"-~0.0\"]\n",
    "data = data[data[\"Population growth rate (average annual %)\"] != \"~0.0\"]\n",
    "data = data[data[\"Population growth rate (average annual %)\"] != \"-~0.0\"]\n",
    "data[\"GDP growth rate (annual %, const. 2005 prices)\"] = data[\"GDP growth rate (annual %, const. 2005 prices)\"].astype(float)\n",
    "data[\"Population growth rate (average annual %)\"] = data[\"Population growth rate (average annual %)\"].astype(float)\n",
    "data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 204 entries, 0 to 228\n",
      "Data columns (total 24 columns):\n",
      "country                                                  204 non-null object\n",
      "Region                                                   204 non-null object\n",
      "Population in thousands (2017)                           204 non-null int64\n",
      "Population density (per km2, 2017)                       204 non-null float64\n",
      "Sex ratio (m per 100 f, 2017)                            204 non-null float64\n",
      "GDP: Gross domestic product (million current US$)        204 non-null int64\n",
      "GDP growth rate (annual %, const. 2005 prices)           204 non-null float64\n",
      "GDP per capita (current US$)                             204 non-null float64\n",
      "Economy: Agriculture (% of GVA)                          204 non-null object\n",
      "Economy: Industry (% of GVA)                             204 non-null float64\n",
      "Economy: Services and other activity (% of GVA)          204 non-null float64\n",
      "Employment: Agriculture (% of employed)                  204 non-null object\n",
      "Employment: Industry (% of employed)                     204 non-null object\n",
      "Employment: Services (% of employed)                     204 non-null object\n",
      "Unemployment (% of labour force)                         204 non-null object\n",
      "International trade: Balance (million US$)               204 non-null object\n",
      "Population growth rate (average annual %)                204 non-null float64\n",
      "Urban population (% of total population)                 204 non-null float64\n",
      "Fertility rate, total (live births per woman)            204 non-null object\n",
      "Population age distribution (0-14 / 60+ years, %)        204 non-null object\n",
      "Individuals using the Internet (per 100 inhabitants)     204 non-null int64\n",
      "Threatened species (number)                              204 non-null object\n",
      "Forested area (% of land area)                           204 non-null object\n",
      "CO2 emission estimates (million tons/tons per capita)    204 non-null int64\n",
      "dtypes: float64(8), int64(4), object(12)\n",
      "memory usage: 39.8+ KB\n"
     ]
    }
   ],
   "source": [
    "data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([['Afghanistan', 'SouthernAsia', 35530, ..., '2.1', '9.8/0.3', 63],\n",
       "       ['Albania', 'SouthernEurope', 2930, ..., '28.2', '5.7/2.0', 84],\n",
       "       ['Algeria', 'NorthernAfrica', 41318, ..., '0.8', '145.4/3.7',\n",
       "        5900],\n",
       "       ...,\n",
       "       ['Yemen', 'WesternAsia', 28250, ..., '1', '22.7/0.9', 668],\n",
       "       ['Zambia', 'EasternAfrica', 17094, ..., '65.6', '4.5/0.3', 374],\n",
       "       ['Zimbabwe', 'EasternAfrica', 16530, ..., '37.2', '12.0/0.8', 482]],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 191,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.base import BaseEstimator, TransformerMixin\n",
    "import numpy as np\n",
    "\n",
    "class CombinedAttribute(BaseEstimator, TransformerMixin):\n",
    "\n",
    "    def fit(self, X, y=None):\n",
    "        return self\n",
    "    \n",
    "    def transform(self, X, y=None):\n",
    "        mean_percapita_value = np.mean(X[:, 7])\n",
    "        percentage_deviation = (X[:, 7] - mean_percapita_value)\n",
    "        percentage_deviation = percentage_deviation / mean_percapita_value\n",
    "        return np.c_[X, percentage_deviation]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 193,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>...</th>\n",
       "      <th>15</th>\n",
       "      <th>16</th>\n",
       "      <th>17</th>\n",
       "      <th>18</th>\n",
       "      <th>19</th>\n",
       "      <th>20</th>\n",
       "      <th>21</th>\n",
       "      <th>22</th>\n",
       "      <th>23</th>\n",
       "      <th>24</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>SouthernAsia</td>\n",
       "      <td>35530</td>\n",
       "      <td>54.4</td>\n",
       "      <td>106.3</td>\n",
       "      <td>20270</td>\n",
       "      <td>-2.4</td>\n",
       "      <td>623.2</td>\n",
       "      <td>23.3</td>\n",
       "      <td>23.3</td>\n",
       "      <td>...</td>\n",
       "      <td>-2110</td>\n",
       "      <td>3.2</td>\n",
       "      <td>26.7</td>\n",
       "      <td>5.3</td>\n",
       "      <td>43.2/4.1</td>\n",
       "      <td>42</td>\n",
       "      <td>2.1</td>\n",
       "      <td>9.8/0.3</td>\n",
       "      <td>63</td>\n",
       "      <td>-0.960431</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Albania</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>2930</td>\n",
       "      <td>106.9</td>\n",
       "      <td>101.9</td>\n",
       "      <td>11541</td>\n",
       "      <td>2.6</td>\n",
       "      <td>3984.2</td>\n",
       "      <td>22.4</td>\n",
       "      <td>26</td>\n",
       "      <td>...</td>\n",
       "      <td>-2707</td>\n",
       "      <td>-0.1</td>\n",
       "      <td>57.4</td>\n",
       "      <td>1.7</td>\n",
       "      <td>17.4/19.0</td>\n",
       "      <td>130</td>\n",
       "      <td>28.2</td>\n",
       "      <td>5.7/2.0</td>\n",
       "      <td>84</td>\n",
       "      <td>-0.747033</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Algeria</td>\n",
       "      <td>NorthernAfrica</td>\n",
       "      <td>41318</td>\n",
       "      <td>17.3</td>\n",
       "      <td>102</td>\n",
       "      <td>164779</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4154.1</td>\n",
       "      <td>12.2</td>\n",
       "      <td>37.3</td>\n",
       "      <td>...</td>\n",
       "      <td>-17099</td>\n",
       "      <td>2</td>\n",
       "      <td>70.7</td>\n",
       "      <td>3</td>\n",
       "      <td>29.3/9.4</td>\n",
       "      <td>135</td>\n",
       "      <td>0.8</td>\n",
       "      <td>145.4/3.7</td>\n",
       "      <td>5900</td>\n",
       "      <td>-0.736246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Andorra</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>77</td>\n",
       "      <td>163.8</td>\n",
       "      <td>102.3</td>\n",
       "      <td>2812</td>\n",
       "      <td>0.8</td>\n",
       "      <td>39896.4</td>\n",
       "      <td>0.5</td>\n",
       "      <td>10.8</td>\n",
       "      <td>...</td>\n",
       "      <td>-1255</td>\n",
       "      <td>-1.6</td>\n",
       "      <td>85.1</td>\n",
       "      <td>1.2</td>\n",
       "      <td>14.4/19.0</td>\n",
       "      <td>13</td>\n",
       "      <td>34</td>\n",
       "      <td>0.5/6.4</td>\n",
       "      <td>1</td>\n",
       "      <td>1.53312</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Angola</td>\n",
       "      <td>MiddleAfrica</td>\n",
       "      <td>29784</td>\n",
       "      <td>23.9</td>\n",
       "      <td>96.2</td>\n",
       "      <td>117955</td>\n",
       "      <td>3</td>\n",
       "      <td>4714.1</td>\n",
       "      <td>6.8</td>\n",
       "      <td>51.2</td>\n",
       "      <td>...</td>\n",
       "      <td>12221</td>\n",
       "      <td>3.5</td>\n",
       "      <td>44.1</td>\n",
       "      <td>6</td>\n",
       "      <td>46.8/4.0</td>\n",
       "      <td>146</td>\n",
       "      <td>46.5</td>\n",
       "      <td>34.8/1.4</td>\n",
       "      <td>3902</td>\n",
       "      <td>-0.70069</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            0               1      2      3      4       5    6        7   \\\n",
       "0  Afghanistan    SouthernAsia  35530   54.4  106.3   20270 -2.4    623.2   \n",
       "1      Albania  SouthernEurope   2930  106.9  101.9   11541  2.6   3984.2   \n",
       "2      Algeria  NorthernAfrica  41318   17.3    102  164779  3.8   4154.1   \n",
       "3      Andorra  SouthernEurope     77  163.8  102.3    2812  0.8  39896.4   \n",
       "4       Angola    MiddleAfrica  29784   23.9   96.2  117955    3   4714.1   \n",
       "\n",
       "     8     9     ...         15   16    17   18         19   20    21  \\\n",
       "0  23.3  23.3    ...      -2110  3.2  26.7  5.3   43.2/4.1   42   2.1   \n",
       "1  22.4    26    ...      -2707 -0.1  57.4  1.7  17.4/19.0  130  28.2   \n",
       "2  12.2  37.3    ...     -17099    2  70.7    3   29.3/9.4  135   0.8   \n",
       "3   0.5  10.8    ...      -1255 -1.6  85.1  1.2  14.4/19.0   13    34   \n",
       "4   6.8  51.2    ...      12221  3.5  44.1    6   46.8/4.0  146  46.5   \n",
       "\n",
       "          22    23        24  \n",
       "0    9.8/0.3    63 -0.960431  \n",
       "1    5.7/2.0    84 -0.747033  \n",
       "2  145.4/3.7  5900 -0.736246  \n",
       "3    0.5/6.4     1   1.53312  \n",
       "4   34.8/1.4  3902  -0.70069  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 193,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "attr_adder = CombinedAttribute()\n",
    "data_new_attrib = attr_adder.transform(data.values)\n",
    "data_new_attrib = pd.DataFrame(data_new_attrib)\n",
    "data_new_attrib.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 194,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>country</th>\n",
       "      <th>Region</th>\n",
       "      <th>Population in thousands (2017)</th>\n",
       "      <th>Population density (per km2, 2017)</th>\n",
       "      <th>Sex ratio (m per 100 f, 2017)</th>\n",
       "      <th>GDP: Gross domestic product (million current US$)</th>\n",
       "      <th>GDP growth rate (annual %, const. 2005 prices)</th>\n",
       "      <th>GDP per capita (current US$)</th>\n",
       "      <th>Economy: Agriculture (% of GVA)</th>\n",
       "      <th>Economy: Industry (% of GVA)</th>\n",
       "      <th>...</th>\n",
       "      <th>International trade: Balance (million US$)</th>\n",
       "      <th>Population growth rate (average annual %)</th>\n",
       "      <th>Urban population (% of total population)</th>\n",
       "      <th>Fertility rate, total (live births per woman)</th>\n",
       "      <th>Population age distribution (0-14 / 60+ years, %)</th>\n",
       "      <th>Individuals using the Internet (per 100 inhabitants)</th>\n",
       "      <th>Threatened species (number)</th>\n",
       "      <th>Forested area (% of land area)</th>\n",
       "      <th>CO2 emission estimates (million tons/tons per capita)</th>\n",
       "      <th>standard_deviation</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>SouthernAsia</td>\n",
       "      <td>35530</td>\n",
       "      <td>54.4</td>\n",
       "      <td>106.3</td>\n",
       "      <td>20270</td>\n",
       "      <td>-2.4</td>\n",
       "      <td>623.2</td>\n",
       "      <td>23.3</td>\n",
       "      <td>23.3</td>\n",
       "      <td>...</td>\n",
       "      <td>-2110</td>\n",
       "      <td>3.2</td>\n",
       "      <td>26.7</td>\n",
       "      <td>5.3</td>\n",
       "      <td>43.2/4.1</td>\n",
       "      <td>42</td>\n",
       "      <td>2.1</td>\n",
       "      <td>9.8/0.3</td>\n",
       "      <td>63</td>\n",
       "      <td>-0.960431</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Albania</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>2930</td>\n",
       "      <td>106.9</td>\n",
       "      <td>101.9</td>\n",
       "      <td>11541</td>\n",
       "      <td>2.6</td>\n",
       "      <td>3984.2</td>\n",
       "      <td>22.4</td>\n",
       "      <td>26</td>\n",
       "      <td>...</td>\n",
       "      <td>-2707</td>\n",
       "      <td>-0.1</td>\n",
       "      <td>57.4</td>\n",
       "      <td>1.7</td>\n",
       "      <td>17.4/19.0</td>\n",
       "      <td>130</td>\n",
       "      <td>28.2</td>\n",
       "      <td>5.7/2.0</td>\n",
       "      <td>84</td>\n",
       "      <td>-0.747033</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Algeria</td>\n",
       "      <td>NorthernAfrica</td>\n",
       "      <td>41318</td>\n",
       "      <td>17.3</td>\n",
       "      <td>102</td>\n",
       "      <td>164779</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4154.1</td>\n",
       "      <td>12.2</td>\n",
       "      <td>37.3</td>\n",
       "      <td>...</td>\n",
       "      <td>-17099</td>\n",
       "      <td>2</td>\n",
       "      <td>70.7</td>\n",
       "      <td>3</td>\n",
       "      <td>29.3/9.4</td>\n",
       "      <td>135</td>\n",
       "      <td>0.8</td>\n",
       "      <td>145.4/3.7</td>\n",
       "      <td>5900</td>\n",
       "      <td>-0.736246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Andorra</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>77</td>\n",
       "      <td>163.8</td>\n",
       "      <td>102.3</td>\n",
       "      <td>2812</td>\n",
       "      <td>0.8</td>\n",
       "      <td>39896.4</td>\n",
       "      <td>0.5</td>\n",
       "      <td>10.8</td>\n",
       "      <td>...</td>\n",
       "      <td>-1255</td>\n",
       "      <td>-1.6</td>\n",
       "      <td>85.1</td>\n",
       "      <td>1.2</td>\n",
       "      <td>14.4/19.0</td>\n",
       "      <td>13</td>\n",
       "      <td>34</td>\n",
       "      <td>0.5/6.4</td>\n",
       "      <td>1</td>\n",
       "      <td>1.53312</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Angola</td>\n",
       "      <td>MiddleAfrica</td>\n",
       "      <td>29784</td>\n",
       "      <td>23.9</td>\n",
       "      <td>96.2</td>\n",
       "      <td>117955</td>\n",
       "      <td>3</td>\n",
       "      <td>4714.1</td>\n",
       "      <td>6.8</td>\n",
       "      <td>51.2</td>\n",
       "      <td>...</td>\n",
       "      <td>12221</td>\n",
       "      <td>3.5</td>\n",
       "      <td>44.1</td>\n",
       "      <td>6</td>\n",
       "      <td>46.8/4.0</td>\n",
       "      <td>146</td>\n",
       "      <td>46.5</td>\n",
       "      <td>34.8/1.4</td>\n",
       "      <td>3902</td>\n",
       "      <td>-0.70069</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       country          Region Population in thousands (2017)  \\\n",
       "0  Afghanistan    SouthernAsia                          35530   \n",
       "1      Albania  SouthernEurope                           2930   \n",
       "2      Algeria  NorthernAfrica                          41318   \n",
       "3      Andorra  SouthernEurope                             77   \n",
       "4       Angola    MiddleAfrica                          29784   \n",
       "\n",
       "  Population density (per km2, 2017) Sex ratio (m per 100 f, 2017)  \\\n",
       "0                               54.4                         106.3   \n",
       "1                              106.9                         101.9   \n",
       "2                               17.3                           102   \n",
       "3                              163.8                         102.3   \n",
       "4                               23.9                          96.2   \n",
       "\n",
       "  GDP: Gross domestic product (million current US$)  \\\n",
       "0                                             20270   \n",
       "1                                             11541   \n",
       "2                                            164779   \n",
       "3                                              2812   \n",
       "4                                            117955   \n",
       "\n",
       "  GDP growth rate (annual %, const. 2005 prices) GDP per capita (current US$)  \\\n",
       "0                                           -2.4                        623.2   \n",
       "1                                            2.6                       3984.2   \n",
       "2                                            3.8                       4154.1   \n",
       "3                                            0.8                      39896.4   \n",
       "4                                              3                       4714.1   \n",
       "\n",
       "  Economy: Agriculture (% of GVA) Economy: Industry (% of GVA)  \\\n",
       "0                            23.3                         23.3   \n",
       "1                            22.4                           26   \n",
       "2                            12.2                         37.3   \n",
       "3                             0.5                         10.8   \n",
       "4                             6.8                         51.2   \n",
       "\n",
       "         ...         International trade: Balance (million US$)  \\\n",
       "0        ...                                              -2110   \n",
       "1        ...                                              -2707   \n",
       "2        ...                                             -17099   \n",
       "3        ...                                              -1255   \n",
       "4        ...                                              12221   \n",
       "\n",
       "  Population growth rate (average annual %)  \\\n",
       "0                                       3.2   \n",
       "1                                      -0.1   \n",
       "2                                         2   \n",
       "3                                      -1.6   \n",
       "4                                       3.5   \n",
       "\n",
       "  Urban population (% of total population)  \\\n",
       "0                                     26.7   \n",
       "1                                     57.4   \n",
       "2                                     70.7   \n",
       "3                                     85.1   \n",
       "4                                     44.1   \n",
       "\n",
       "  Fertility rate, total (live births per woman)  \\\n",
       "0                                           5.3   \n",
       "1                                           1.7   \n",
       "2                                             3   \n",
       "3                                           1.2   \n",
       "4                                             6   \n",
       "\n",
       "  Population age distribution (0-14 / 60+ years, %)  \\\n",
       "0                                          43.2/4.1   \n",
       "1                                         17.4/19.0   \n",
       "2                                          29.3/9.4   \n",
       "3                                         14.4/19.0   \n",
       "4                                          46.8/4.0   \n",
       "\n",
       "  Individuals using the Internet (per 100 inhabitants)  \\\n",
       "0                                                 42     \n",
       "1                                                130     \n",
       "2                                                135     \n",
       "3                                                 13     \n",
       "4                                                146     \n",
       "\n",
       "  Threatened species (number) Forested area (% of land area)  \\\n",
       "0                         2.1                        9.8/0.3   \n",
       "1                        28.2                        5.7/2.0   \n",
       "2                         0.8                      145.4/3.7   \n",
       "3                          34                        0.5/6.4   \n",
       "4                        46.5                       34.8/1.4   \n",
       "\n",
       "  CO2 emission estimates (million tons/tons per capita) standard_deviation  \n",
       "0                                                 63             -0.960431  \n",
       "1                                                 84             -0.747033  \n",
       "2                                               5900             -0.736246  \n",
       "3                                                  1               1.53312  \n",
       "4                                               3902              -0.70069  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 194,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "columns = list(columns)\n",
    "columns.append(\"standard_deviation\")\n",
    "data_new_attrib.columns = columns\n",
    "data_new_attrib.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 195,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_new_attrib['current_state'] = np.where((data_new_attrib['standard_deviation']>0), 'developed', 'under_developed')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 196,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>country</th>\n",
       "      <th>Region</th>\n",
       "      <th>Population in thousands (2017)</th>\n",
       "      <th>Population density (per km2, 2017)</th>\n",
       "      <th>Sex ratio (m per 100 f, 2017)</th>\n",
       "      <th>GDP: Gross domestic product (million current US$)</th>\n",
       "      <th>GDP growth rate (annual %, const. 2005 prices)</th>\n",
       "      <th>GDP per capita (current US$)</th>\n",
       "      <th>Economy: Agriculture (% of GVA)</th>\n",
       "      <th>Economy: Industry (% of GVA)</th>\n",
       "      <th>...</th>\n",
       "      <th>Population growth rate (average annual %)</th>\n",
       "      <th>Urban population (% of total population)</th>\n",
       "      <th>Fertility rate, total (live births per woman)</th>\n",
       "      <th>Population age distribution (0-14 / 60+ years, %)</th>\n",
       "      <th>Individuals using the Internet (per 100 inhabitants)</th>\n",
       "      <th>Threatened species (number)</th>\n",
       "      <th>Forested area (% of land area)</th>\n",
       "      <th>CO2 emission estimates (million tons/tons per capita)</th>\n",
       "      <th>standard_deviation</th>\n",
       "      <th>current_state</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>SouthernAsia</td>\n",
       "      <td>35530</td>\n",
       "      <td>54.4</td>\n",
       "      <td>106.3</td>\n",
       "      <td>20270</td>\n",
       "      <td>-2.4</td>\n",
       "      <td>623.2</td>\n",
       "      <td>23.3</td>\n",
       "      <td>23.3</td>\n",
       "      <td>...</td>\n",
       "      <td>3.2</td>\n",
       "      <td>26.7</td>\n",
       "      <td>5.3</td>\n",
       "      <td>43.2/4.1</td>\n",
       "      <td>42</td>\n",
       "      <td>2.1</td>\n",
       "      <td>9.8/0.3</td>\n",
       "      <td>63</td>\n",
       "      <td>-0.960431</td>\n",
       "      <td>under_developed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Albania</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>2930</td>\n",
       "      <td>106.9</td>\n",
       "      <td>101.9</td>\n",
       "      <td>11541</td>\n",
       "      <td>2.6</td>\n",
       "      <td>3984.2</td>\n",
       "      <td>22.4</td>\n",
       "      <td>26</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.1</td>\n",
       "      <td>57.4</td>\n",
       "      <td>1.7</td>\n",
       "      <td>17.4/19.0</td>\n",
       "      <td>130</td>\n",
       "      <td>28.2</td>\n",
       "      <td>5.7/2.0</td>\n",
       "      <td>84</td>\n",
       "      <td>-0.747033</td>\n",
       "      <td>under_developed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Algeria</td>\n",
       "      <td>NorthernAfrica</td>\n",
       "      <td>41318</td>\n",
       "      <td>17.3</td>\n",
       "      <td>102</td>\n",
       "      <td>164779</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4154.1</td>\n",
       "      <td>12.2</td>\n",
       "      <td>37.3</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>70.7</td>\n",
       "      <td>3</td>\n",
       "      <td>29.3/9.4</td>\n",
       "      <td>135</td>\n",
       "      <td>0.8</td>\n",
       "      <td>145.4/3.7</td>\n",
       "      <td>5900</td>\n",
       "      <td>-0.736246</td>\n",
       "      <td>under_developed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Andorra</td>\n",
       "      <td>SouthernEurope</td>\n",
       "      <td>77</td>\n",
       "      <td>163.8</td>\n",
       "      <td>102.3</td>\n",
       "      <td>2812</td>\n",
       "      <td>0.8</td>\n",
       "      <td>39896.4</td>\n",
       "      <td>0.5</td>\n",
       "      <td>10.8</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.6</td>\n",
       "      <td>85.1</td>\n",
       "      <td>1.2</td>\n",
       "      <td>14.4/19.0</td>\n",
       "      <td>13</td>\n",
       "      <td>34</td>\n",
       "      <td>0.5/6.4</td>\n",
       "      <td>1</td>\n",
       "      <td>1.53312</td>\n",
       "      <td>developed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Angola</td>\n",
       "      <td>MiddleAfrica</td>\n",
       "      <td>29784</td>\n",
       "      <td>23.9</td>\n",
       "      <td>96.2</td>\n",
       "      <td>117955</td>\n",
       "      <td>3</td>\n",
       "      <td>4714.1</td>\n",
       "      <td>6.8</td>\n",
       "      <td>51.2</td>\n",
       "      <td>...</td>\n",
       "      <td>3.5</td>\n",
       "      <td>44.1</td>\n",
       "      <td>6</td>\n",
       "      <td>46.8/4.0</td>\n",
       "      <td>146</td>\n",
       "      <td>46.5</td>\n",
       "      <td>34.8/1.4</td>\n",
       "      <td>3902</td>\n",
       "      <td>-0.70069</td>\n",
       "      <td>under_developed</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       country          Region Population in thousands (2017)  \\\n",
       "0  Afghanistan    SouthernAsia                          35530   \n",
       "1      Albania  SouthernEurope                           2930   \n",
       "2      Algeria  NorthernAfrica                          41318   \n",
       "3      Andorra  SouthernEurope                             77   \n",
       "4       Angola    MiddleAfrica                          29784   \n",
       "\n",
       "  Population density (per km2, 2017) Sex ratio (m per 100 f, 2017)  \\\n",
       "0                               54.4                         106.3   \n",
       "1                              106.9                         101.9   \n",
       "2                               17.3                           102   \n",
       "3                              163.8                         102.3   \n",
       "4                               23.9                          96.2   \n",
       "\n",
       "  GDP: Gross domestic product (million current US$)  \\\n",
       "0                                             20270   \n",
       "1                                             11541   \n",
       "2                                            164779   \n",
       "3                                              2812   \n",
       "4                                            117955   \n",
       "\n",
       "  GDP growth rate (annual %, const. 2005 prices) GDP per capita (current US$)  \\\n",
       "0                                           -2.4                        623.2   \n",
       "1                                            2.6                       3984.2   \n",
       "2                                            3.8                       4154.1   \n",
       "3                                            0.8                      39896.4   \n",
       "4                                              3                       4714.1   \n",
       "\n",
       "  Economy: Agriculture (% of GVA) Economy: Industry (% of GVA)  \\\n",
       "0                            23.3                         23.3   \n",
       "1                            22.4                           26   \n",
       "2                            12.2                         37.3   \n",
       "3                             0.5                         10.8   \n",
       "4                             6.8                         51.2   \n",
       "\n",
       "        ...        Population growth rate (average annual %)  \\\n",
       "0       ...                                              3.2   \n",
       "1       ...                                             -0.1   \n",
       "2       ...                                                2   \n",
       "3       ...                                             -1.6   \n",
       "4       ...                                              3.5   \n",
       "\n",
       "  Urban population (% of total population)  \\\n",
       "0                                     26.7   \n",
       "1                                     57.4   \n",
       "2                                     70.7   \n",
       "3                                     85.1   \n",
       "4                                     44.1   \n",
       "\n",
       "  Fertility rate, total (live births per woman)  \\\n",
       "0                                           5.3   \n",
       "1                                           1.7   \n",
       "2                                             3   \n",
       "3                                           1.2   \n",
       "4                                             6   \n",
       "\n",
       "  Population age distribution (0-14 / 60+ years, %)  \\\n",
       "0                                          43.2/4.1   \n",
       "1                                         17.4/19.0   \n",
       "2                                          29.3/9.4   \n",
       "3                                         14.4/19.0   \n",
       "4                                          46.8/4.0   \n",
       "\n",
       "  Individuals using the Internet (per 100 inhabitants)  \\\n",
       "0                                                 42     \n",
       "1                                                130     \n",
       "2                                                135     \n",
       "3                                                 13     \n",
       "4                                                146     \n",
       "\n",
       "  Threatened species (number) Forested area (% of land area)  \\\n",
       "0                         2.1                        9.8/0.3   \n",
       "1                        28.2                        5.7/2.0   \n",
       "2                         0.8                      145.4/3.7   \n",
       "3                          34                        0.5/6.4   \n",
       "4                        46.5                       34.8/1.4   \n",
       "\n",
       "  CO2 emission estimates (million tons/tons per capita) standard_deviation  \\\n",
       "0                                                 63             -0.960431   \n",
       "1                                                 84             -0.747033   \n",
       "2                                               5900             -0.736246   \n",
       "3                                                  1               1.53312   \n",
       "4                                               3902              -0.70069   \n",
       "\n",
       "     current_state  \n",
       "0  under_developed  \n",
       "1  under_developed  \n",
       "2  under_developed  \n",
       "3        developed  \n",
       "4  under_developed  \n",
       "\n",
       "[5 rows x 26 columns]"
      ]
     },
     "execution_count": 196,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_new_attrib.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 197,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "under_developed    145\n",
       "developed           59\n",
       "Name: current_state, dtype: int64"
      ]
     },
     "execution_count": 197,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_new_attrib['current_state'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 198,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "gradually developing    166\n",
      "Highly developing        19\n",
      "Highly declining         19\n",
      "Name: prediction_status, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "col_needed = [\"country\", \"GDP_percapita\", \"population_growth%\", \"GDP_growth%\", \"standard_deviation\", \"current_state\", \"prediction_rate\", \"prediction_status\"]\n",
    "df = pd.DataFrame(columns = col_needed)\n",
    "temp = {}\n",
    "j = 0\n",
    "x = 0\n",
    "for i, r in data_new_attrib.iterrows():\n",
    "    temp[\"country\"] = r[\"country\"]\n",
    "    temp[\"GDP_percapita\"] = r[\"GDP per capita (current US$)\"]\n",
    "    temp[\"population_growth%\"] = r[\"Population growth rate (average annual %)\"]\n",
    "    temp[\"GDP_growth%\"] = r[\"GDP growth rate (annual %, const. 2005 prices)\"]\n",
    "    temp[\"standard_deviation\"] = r[\"standard_deviation\"]\n",
    "    temp[\"current_state\"] = r[\"current_state\"]\n",
    "    x = r[\"GDP growth rate (annual %, const. 2005 prices)\"] / r[\"Population growth rate (average annual %)\"]\n",
    "    temp[\"prediction_rate\"] = abs(x)\n",
    "    if (temp[\"population_growth%\"] < 0) and (temp[\"GDP_growth%\"] > 0):\n",
    "        temp[\"prediction_status\"] = \"Highly developing\"\n",
    "    elif (temp[\"population_growth%\"] > 0) and (temp[\"GDP_growth%\"] < 0):\n",
    "        temp[\"prediction_status\"] = \"Highly declining\"\n",
    "    else:\n",
    "        temp[\"prediction_status\"] = \"gradually developing\"\n",
    "    df.loc[j] = pd.Series(temp)\n",
    "    temp = {}\n",
    "    j += 1\n",
    "print(df[\"prediction_status\"].value_counts())\n",
    "df.to_csv(\"data_one.csv\")\n",
    "    \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
